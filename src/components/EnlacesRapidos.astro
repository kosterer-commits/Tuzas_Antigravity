---
// EnlacesRapidos.astro — Panel deslizante lateral izquierdo con enlaces institucionales.
// Incluido en Header.astro para aparecer en todas las páginas.
const BASE = import.meta.env.BASE_URL;

const enlaces = [
    {
        nombre: "Educación a Distancia",
        descripcion: "Plataforma virtual Moodle",
        href: "http://virtual.itpachuca.edu.mx/moodle/",
        icono: `${BASE}icons/EAD.png`,
        externo: true,
    },
    {
        nombre: "SII",
        descripcion: "Sistema Integral de Información",
        href: "http://escolaresitp.itpachuca.edu.mx/",
        icono: `${BASE}icons/sii.png`,
        externo: true,
    },
    {
        nombre: "Contraloría Social",
        descripcion: "Transparencia institucional",
        href: "#",
        icono: `${BASE}icons/contraloria_social.png`,
        externo: false,
    },
    {
        nombre: "CONAHCYT",
        descripcion: "Ciencia y tecnología en México",
        href: "http://www.conacyt.gob.mx",
        icono: `${BASE}icons/CONACYT.png`,
        externo: true,
    },
    {
        nombre: "CONRICyT",
        descripcion: "Recursos científicos y tecnológicos",
        href: "https://www.conricyt.mx",
        icono: `${BASE}icons/CONRICYT.png`,
        externo: true,
    },
    {
        nombre: "FESE",
        descripcion: "Fondo para educación superior",
        href: "http://fese.org.mx/",
        icono: `${BASE}icons/fese.png`,
        externo: true,
    },
    {
        nombre: "INAI",
        descripcion: "Acceso a la información y privacidad",
        href: "https://home.inai.org.mx/",
        icono: `${BASE}icons/INAI.png`,
        externo: true,
    },
    {
        nombre: "PNT",
        descripcion: "Plataforma Nacional de Transparencia",
        href: "https://www.plataformanacionaldetransparencia.org.mx/",
        icono: `${BASE}icons/PNT.png`,
        externo: true,
    },
    {
        nombre: "CONAMTEC",
        descripcion: "Normatividad institucional",
        href: "#",
        icono: `${BASE}icons/conamtec.png`,
        externo: false,
    },
    {
        nombre: "Encuesta",
        descripcion: "Encuesta de satisfacción",
        href: "#",
        icono: `${BASE}icons/Encuesta.png`,
        externo: false,
    },
    {
        nombre: "Correo Institucional",
        descripcion: "Accede a tu correo TecNM",
        href: "https://mail.google.com/a/itpachuca.edu.mx",
        icono: `${BASE}icons/en.png`,
        externo: true,
    },
];
---

<!-- Tab trigger on left edge -->
<button
    id="enlaces-tab"
    aria-label="Abrir enlaces rápidos institucionales"
    aria-expanded="false"
    class="fixed left-0 top-1/2 -translate-y-1/2 z-[9001]
           bg-blue-600 text-white
           flex flex-col items-center justify-center gap-1.5
           w-8 py-5 rounded-r-2xl shadow-xl
           hover:w-10 hover:bg-blue-700
           transition-all duration-300 ease-out
           focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-1"
>
    <!-- Link icon -->
    <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-4 h-4 shrink-0"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
    >
        <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101
               m.793-3.897a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656
               l-1.1 1.1"
        ></path>
    </svg>
    <!-- Rotated label -->
    <span
        class="text-[9px] font-black tracking-[0.15em] uppercase"
        style="writing-mode:vertical-rl; transform:rotate(180deg); white-space:nowrap;"
    >
        Enlaces
    </span>
</button>

<!-- Overlay -->
<div
    id="enlaces-overlay"
    aria-hidden="true"
    class="fixed inset-0 z-[9002] bg-black/30 opacity-0 invisible pointer-events-none transition-opacity duration-300"
>
</div>

<!-- Side Panel -->
<aside
    id="enlaces-panel"
    role="dialog"
    aria-modal="true"
    aria-label="Enlaces institucionales"
    aria-hidden="true"
    class="fixed top-0 left-0 h-full w-72 max-w-[90vw] z-[9003] flex flex-col
           bg-white shadow-2xl
           transform -translate-x-full transition-transform duration-500
           ease-[cubic-bezier(0.77,0,0.175,1)] overflow-y-auto"
>
    <!-- Header -->
    <div
        class="flex items-center justify-between px-5 py-4 bg-blue-600 text-white shrink-0"
    >
        <div class="flex items-center gap-2">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-5 h-5 shrink-0"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101
                       m.793-3.897a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"
                ></path>
            </svg>
            <div>
                <p class="font-bold text-sm leading-tight">Enlaces Rápidos</p>
                <p class="text-blue-200 text-xs">Accesos institucionales</p>
            </div>
        </div>
        <button
            id="enlaces-close-btn"
            aria-label="Cerrar panel de enlaces"
            class="p-1.5 rounded-full hover:bg-white/20 transition-colors focus:outline-none focus:ring-2 focus:ring-white/50"
        >
            <svg
                class="w-4 h-4"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
    </div>

    <!-- Links list -->
    <nav
        class="flex-1 py-3 px-3 space-y-1"
        aria-label="Lista de enlaces institucionales"
    >
        {
            enlaces.map((enlace) => (
                <a
                    href={enlace.href}
                    target={enlace.externo ? "_blank" : "_self"}
                    rel={enlace.externo ? "noopener noreferrer" : undefined}
                    class="enlace-item flex items-center gap-3 px-3 py-2.5 rounded-xl
                       hover:bg-blue-50 hover:shadow-sm
                       transition-all duration-200 group"
                >
                    <div
                        class="w-10 h-10 shrink-0 flex items-center justify-center
                            bg-gray-50 rounded-xl border border-gray-100
                            group-hover:bg-white group-hover:border-blue-200 transition-all"
                    >
                        <img
                            src={enlace.icono}
                            alt={enlace.nombre}
                            class="w-7 h-7 object-contain"
                            loading="lazy"
                        />
                    </div>
                    <div class="min-w-0 flex-1">
                        <p
                            class="text-sm font-semibold text-gray-800 group-hover:text-blue-600
                               transition-colors leading-tight truncate"
                        >
                            {enlace.nombre}
                        </p>
                        <p class="text-xs text-gray-400 leading-tight truncate mt-0.5">
                            {enlace.descripcion}
                        </p>
                    </div>
                    {enlace.externo && (
                        <svg
                            class="w-3.5 h-3.5 text-gray-300 group-hover:text-blue-400 shrink-0 transition-colors"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                            />
                        </svg>
                    )}
                </a>
            ))
        }
    </nav>

    <!-- Footer -->
    <div class="px-5 py-4 border-t border-gray-100 shrink-0">
        <p class="text-xs text-gray-400 text-center leading-relaxed">
            Instituto Tecnológico de Pachuca<br />
            <span class="text-blue-500 font-medium">itpachuca.edu.mx</span>
        </p>
    </div>
</aside>

<script>
    const tab = document.getElementById("enlaces-tab")!;
    const panel = document.getElementById("enlaces-panel")!;
    const overlay = document.getElementById("enlaces-overlay")!;
    const closeBtn = document.getElementById("enlaces-close-btn")!;

    function openPanel() {
        panel.classList.remove("-translate-x-full");
        overlay.classList.remove(
            "opacity-0",
            "invisible",
            "pointer-events-none",
        );
        overlay.classList.add("opacity-100", "pointer-events-auto");
        panel.setAttribute("aria-hidden", "false");
        tab.setAttribute("aria-expanded", "true");
        closeBtn.focus();
    }

    function closePanel() {
        panel.classList.add("-translate-x-full");
        overlay.classList.add("opacity-0", "invisible", "pointer-events-none");
        overlay.classList.remove("opacity-100", "pointer-events-auto");
        panel.setAttribute("aria-hidden", "true");
        tab.setAttribute("aria-expanded", "false");
        tab.focus();
    }

    tab.addEventListener("click", () => {
        panel.getAttribute("aria-hidden") === "false"
            ? closePanel()
            : openPanel();
    });
    closeBtn.addEventListener("click", closePanel);
    overlay.addEventListener("click", closePanel);
    document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closePanel();
    });
</script>
